# Революция в микрофронтендах, Module Federation, Webpack 5

Презентация доступна по следующим ссылкам:
- [темная тема](https://nodkz.github.io/conf-talks/talks/2020.10.26-webpack-federation/index.html)
- [светлая теме](https://nodkz.github.io/conf-talks/talks/2020.10.26-webpack-federation/white.html)

У вас большой фронтенд и работает много разработчиков нам ним? Сборка новой версии, время деплоя, прогона всех интеграционных тестов занимает много часов? Частенько возникают вопросы о том, по чьей вине что-то упало рантайме?

В мире бэкенда давно уже воспользовались принципом "разделяй и властвую", и распилили свои монолиты на микросервисы (SOA). Провели разделение ответственности, определили владельцев кода, инкапсулировали знания предметной области, сократили время обучения новых сотрудников, ускорили время тестирования и настроили независимые деплои.

Последние 5 лет в современном мире SPA об этом деле не раз задумывались разные банки и классифайды. И в youtube можно найти десятки докладов про реализацию микрофронтендов. Но достойного стандарта в индустрии так и не сформировалось. Кто-то пилит свои дорогие in-house решения, кто-то мучается с дублирующимися библиотеками и модальными окнами в zoid, кто-то костылит подгрузку ассетов в single-spa (css, fonts, images).

И я нашел рыбу своей мечты – это module federation в Webpack 5. Вы можете заимпортировать в свое приложение любой внешний модуль/компонент из где-то на другом сервере задеплоенного  отдельно собранного webpack'ом приложения. Всё прям как во времена jQuery, взяли подтянули плагин с cdn, вставили на страницу и все заработало.

Павел расскажет и покажет как работает module federation в Webpack 5. Как его прикрутить к Next.js 9.5. Даст ссылки на кучу демок для Angular, Vue, Svelte. Zack Jackson и Tobias Koppers проделали огромную работу, чтобы предложить достойный стандарт в индустрии для микрофронтендов.

------

- Почему выбрали эту тему?
С середины 2020 года исследую вопрос того, как объединить наши разрозненные NextJS приложения на разных поддоменах (админки различных сервисов) в один большой личный кабинет с единой шапкой и меню. Чтобы при переходе между сервисами не было перезагрузки страницы в браузере. При этом, чтобы разработчики сервисов могли влиять на работу меню и шапки из своих приложений, добавляя свои элементы и логику. Разделение ответственности, независимые деплои у нас уже давно есть, теперь бы как-то склеить все это красиво. И оказывается, это тема не такая простая, как кажется на первый взгляд. Просмотрено куча инструментов, сделан анализ, найдено решение. И спрятать это всё дело в тумбочку было бы кощунством.

- Почему рассказывает именно этот спикер?
Павел обычно рассказывает про GraphQL. Но мимо Module Federation, который, по его мнению, сильно повлияет на индустрию корпоративного фронтенда, он просто не смог пройти мимо.

- Кому и зачем идти на этот доклад?
Этот доклад будет интересен тем, кто хочет собрать несколько разрозненных приложений в один SPA. Ну или разбить большой монолитный SPA на несколько небольших. Ох уж эти инженеры, сперва мучаются что-то разбивают, а потом это самое разбитое обратно как-то хитро склеивают. Ненормальные... Если вам интересно как, а главное зачем инженеры занимаются этой "ерундой", то обязательно приходите посмотреть и послушать про микрофронтенды.

-----

Проблемы:
- фронтенд большой, и несколько команд его пилят
- разделение ответственности (кто за что отвечает)
- долгие часы CI/CD и интеграционных тестов, чтоб собрать монолитный фронтенд

А как было здорово лет 5 тому назад:
- никаких билдов, влепил jquery плагин на страницу и поехали
- сейчас с билдами боишься лишний скрипт подключить. Такое ощущение, что атрофировалось способность что-то подключать руками.

Текущие решения:
- свой велосипед (обычно дорого – тесты, документация, bus factor)
  - синхронизация версий компонентов между приложениями
- zoid (боль с модальными окнами, одни и те же библиотеки загружаются несколько раз)
- single-spa (погружаемся в systemjs и мапперы, что-то костылим с подгрузкой ассетов css, fonts, images)
- module federation в webpack 5 (вот она рыба моей мечты. Еще релиза нет, но уже можно пользоваться.)

Демо:
- как работает (неглубоко без кишков)
- кто реализует и можно ли доверять
- где посмотреть больше демок
- будут ли проблемы со сборкой, хэшами, ошибки в рантайме

Что дальше:
- Ждем Next.js 10, но уже сейчас можно клеить микрофронтенды.
- Выход с докладом на весну 2021: apollo federation, webpack module federation, russian federation – как сделать так, чтобы все федерации работали как часы?!

--------

Павел Черторогов
ps.kz, Архитектор информационных систем
<https://www.dropbox.com/s/22mncow425wsvwu/%20HolyJS%20%D0%BF%D0%BE%D1%80%D1%82%D1%80%D0%B5%D1%82%D1%8B%20%D1%81%D0%BF%D0%B8%D0%BA%D0%B5%D1%80%D0%BE%D0%B2-53.jpg?dl=0>

GraphQL гуру, разработчик интернет-продуктов, опенсорс-мейнтейнер. Сделал более 15 докладов о GraphQL и провел более 5 воркшопов как на клиенте, так и сервере. В веб разработке с 2001 года. Обладает обширными практическими знаниями по бэкенду, фронтенду, администрированию и построению архитектуры. В 2016 начал разработку graphql-compose (генератора GraphQL-схем). Написал много материала о GraphQL на русском – <https://github.com/nodkz/conf-talks>. В 2019 начал формировать best practice по дизайну GraphQL-схем – <https://graphql-rules.com>.

Сделал более 15 докладов и 5 воркшопов про GraphQL как на клиенте, так и сервере.

Twitter – @nodkz
Telegram – <https://t.me/graphql_ru>
GitHub – <https://github.com/nodkz>
